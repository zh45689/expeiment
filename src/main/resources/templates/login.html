<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>登录页面</title>
		<!-- 必须先引入vue.js，才能引入elementui的index.js -->
		<!--localhost:8080/exp/pages/index.html-->
		<script src="js/vue.js"></script>
		<script src="js/axios.min.js"></script>
		<link rel="stylesheet" href="css/index.css">
		<script src="js/index.js"></script>
	</head>
	<body>
		<div id="box">
			<el-form :rules="rules" ref="userinfo" :model="userinfo" label-width="80px">
				<el-form-item label="账号" prop="username">
				    <el-input v-model="userinfo.username"></el-input>
				</el-form-item>
				<el-form-item label="密码" prop="password">
				    <el-input type="password" v-model="userinfo.password"></el-input>
				</el-form-item>
				<el-form-item>
				    <el-button type="primary" @click="login('userinfo')">登录</el-button>
				</el-form-item>
			</el-form>
		</div>
		
		<script>
			new Vue({
				el:"#box",
				data:{
					userinfo:{
						username:"",
						password:""
					},
					rules:{
						username: [
							{ required: true, message: '账号不能为空！', trigger: 'blur' },
							{ min: 2, max: 10, message: '长度在 2 到 10 个字符', trigger: 'blur'}
						],
						password: [
							{ required: true, message: '密码不能为空！', trigger: 'blur' },
							{ min: 3, max: 8, message: '长度在 3 到 8 个字符', trigger: 'blur'}
						]
					}
				},
				methods:{
					login:function(userinfo){//传来的参数是字符串
						//验证userinfo这个对象的属性是否符合规则
						var username = this.userinfo.username;
						var password = this.userinfo.password;
						this.$refs[userinfo].validate((valid) => {
				          if (valid) {
							  axios.get("login?username="+username+"&password="+password).then(function(res){
								  if(res.data.status){
									  location.href = "index";
								  }else{
									  alert(res.data.message);
								  }
							  });
				          } else {
				          	this.$message.error('请按规则填写代码！');
				          }
				        });
					}
				}
			})
		</script>
		
	</body>
</html>
